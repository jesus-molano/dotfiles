# --- CATPPUCCIN MOCHA THEME ---
source = ~/.config/hypr/mocha.conf

################
### MONITORS ###
################
# --- MONITOR ---
monitor = desc:Philips Consumer Electronics Company PHL 273V7 0x00000B97, 1920x1080@74.97, 1920x0, 1
monitor = desc:Philips Consumer Electronics Company PHL 273V7 0x00000C52, 1920x1080@74.97, 0x0, 1
monitor = , preferred, auto, 1  # Fallback for hot-plugged monitors

# --- ENV VARS (CR√çTICO PARA NVIDIA) ---
env = LIBVA_DRIVER_NAME,nvidia
env = XDG_SESSION_TYPE,wayland
env = GBM_BACKEND,nvidia-drm
env = __GLX_VENDOR_LIBRARY_NAME,nvidia
env = NVD_BACKEND,direct
env = ELECTRON_OZONE_PLATFORM_HINT,auto
env = ENABLE_VKBASALT,1

# --- CURSOR THEME ---
# XCURSOR_* = XWayland apps | HYPRCURSOR_* = native Hyprland
env = XCURSOR_THEME,catppuccin-mocha-dark-cursors
env = XCURSOR_SIZE,24
env = HYPRCURSOR_THEME,catppuccin-mocha-dark-cursors
env = HYPRCURSOR_SIZE,24

# --- QT THEMING ---
env = QT_QPA_PLATFORMTHEME,qt6ct

# --- AUTOSTART ---
exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = /usr/lib/polkit-kde-authentication-agent-1
exec-once = waybar & swww-daemon & swaync
exec-once = sleep 1 && swww img $HOME/Pictures/wallhaven-ogy6zm_1920x1080.png
exec-once = ~/.config/hypr/scripts/reactive-rgb.sh &
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store
exec-once = hypridle
exec-once = ~/.config/hypr/scripts/wait-monitor.sh

# --- INPUT ---
input {
    kb_layout = us,es
    follow_mouse = 1
    sensitivity = 0
    repeat_rate = 50
    repeat_delay = 300
}

# --- GENERAL ---
general {
    gaps_in = 4
    gaps_out = 8
    border_size = 2
    col.active_border = $mauve $blue 45deg
    col.inactive_border = $surface0
    layout = dwindle
    allow_tearing = true
}

decoration {
    rounding = 10
    blur {
        enabled = true
        size = 5
        passes = 2
        ignore_opacity = true
    }
}

animations {
    enabled = true
    bezier = md3_decel, 0.05, 0.7, 0.1, 1
    animation = windows, 1, 3, md3_decel, popin 60%
    animation = fade, 1, 3, md3_decel
    animation = border, 1, 5, md3_decel
    animation = borderangle, 1, 30, md3_decel, loop
    animation = workspaces, 1, 3, md3_decel, slide
}

dwindle {
    pseudotile = true
    preserve_split = true
}

misc {
    disable_hyprland_logo = true
    force_default_wallpaper = 0
    vfr = true
    on_focus_under_fullscreen = 2
}

xwayland {
    force_zero_scaling = true
}

binds {
    allow_workspace_cycles = true
}

# --- VARIABLES ---
$mainMod = ALT
$hyper = CTRL ALT SUPER SHIFT

# --- BINDS ---
# Cambio de idioma: SUPER + SPACE
bind = SUPER, SPACE, exec, hyprctl switchxkblayout all next && notify-send -t 1500 -h string:x-canonical-private-synchronous:kbd "Û∞åå $(hyprctl devices -j | jq -r '[.keyboards[] | select(.main)][0].active_keymap')"

# Apps
bind = $mainMod, SPACE, exec, ~/.config/rofi/launchers/type-1/launcher.sh
bind = $hyper, RETURN, exec, kitty
bind = $hyper, B, exec, google-chrome-stable
bind = $hyper, E, exec, kitty -e yazi
bind = $hyper, C, exec, webstorm # IDE
bind = $hyper, N, exec, swaync-client -t -sw
bind = $hyper, P, exec, hyprpicker -a
bind = $hyper, M, exec, youtube-music
bind = $hyper, G, exec, mangohudctl toggle
bind = $hyper, D, exec, discord
bind = $hyper, 1, exec, 1password
bind = $hyper, L, exec, hyprlock
bind = $hyper, slash, exec, ~/.config/hypr/scripts/keybinds.sh
bind = $hyper, period, exec, ~/.config/hypr/scripts/claude-skills.sh
bind = $hyper, comma, exec, ~/.config/hypr/scripts/nvim-keys.sh

# Window Management (VIM HJKL)
bind = $mainMod, W, killactive
bind = $mainMod, h, movefocus, l
bind = $mainMod, l, movefocus, r
bind = $mainMod, k, movefocus, u
bind = $mainMod, j, movefocus, d


# Resize
binde = $mainMod CTRL, l, resizeactive, 40 0
binde = $mainMod CTRL, h, resizeactive, -40 0
binde = $mainMod CTRL, k, resizeactive, 0 -40
binde = $mainMod CTRL, j, resizeactive, 0 40

# Mouse bindings
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

# Workspaces
bind = $mainMod, 1, focusworkspaceoncurrentmonitor, 1
bind = $mainMod, 2, focusworkspaceoncurrentmonitor, 2
bind = $mainMod, 3, focusworkspaceoncurrentmonitor, 3
bind = $mainMod, 4, focusworkspaceoncurrentmonitor, 4
bind = $mainMod, 5, focusworkspaceoncurrentmonitor, 5
bind = $mainMod, 6, focusworkspaceoncurrentmonitor, 6
bind = $mainMod, 7, focusworkspaceoncurrentmonitor, 7
bind = $mainMod, 8, focusworkspaceoncurrentmonitor, 8

bind = $mainMod SHIFT, 1, movetoworkspace, 1
bind = $mainMod SHIFT, 2, movetoworkspace, 2
bind = $mainMod SHIFT, 3, movetoworkspace, 3
bind = $mainMod SHIFT, 4, movetoworkspace, 4
bind = $mainMod SHIFT, 5, movetoworkspace, 5
bind = $mainMod SHIFT, 6, movetoworkspace, 6
bind = $mainMod SHIFT, 7, movetoworkspace, 7
bind = $mainMod SHIFT, 8, movetoworkspace, 8

# --- WORKSPACE RULES (monitor assignment) ---
# Odd ‚Üí right (B97), Even ‚Üí left (C52)
workspace = 1, monitor:desc:Philips Consumer Electronics Company PHL 273V7 0x00000B97
workspace = 2, monitor:desc:Philips Consumer Electronics Company PHL 273V7 0x00000C52
workspace = 3, monitor:desc:Philips Consumer Electronics Company PHL 273V7 0x00000B97
workspace = 4, monitor:desc:Philips Consumer Electronics Company PHL 273V7 0x00000C52
workspace = 5, monitor:desc:Philips Consumer Electronics Company PHL 273V7 0x00000B97
workspace = 6, monitor:desc:Philips Consumer Electronics Company PHL 273V7 0x00000C52
workspace = 7, monitor:desc:Philips Consumer Electronics Company PHL 273V7 0x00000B97
workspace = 8, monitor:desc:Philips Consumer Electronics Company PHL 273V7 0x00000C52

bind = $mainMod, M, fullscreen
bind = $mainMod, F, togglefloating
bind = $mainMod, C, exec, ~/.config/hypr/scripts/super-copy.sh
bind = $mainMod, V, exec, ~/.config/hypr/scripts/super-paste.sh
bind = $mainMod SHIFT, V, exec, cliphist list | rofi -dmenu -p "Clipboard" -theme ~/.config/rofi/launchers/type-1/style-2.rasi | cliphist decode | wl-copy
bind = $mainMod, A, exec, ~/.config/hypr/scripts/audio-toggle.sh

# --- Scratchpad ---
bind = $mainMod, grave, togglespecialworkspace, scratchpad
bind = $mainMod SHIFT, grave, movetoworkspace, special:scratchpad

# --- Group/Tab bindings ---
bind = $mainMod, G, togglegroup
bind = $mainMod, TAB, changegroupactive, f
bind = $mainMod SHIFT, TAB, changegroupactive, b
bind = $mainMod SHIFT, h, movewindoworgroup, l
bind = $mainMod SHIFT, l, movewindoworgroup, r
bind = $mainMod SHIFT, k, movewindoworgroup, u
bind = $mainMod SHIFT, j, movewindoworgroup, d

# --- üì∏ SCREENSHOTS ---
bind = $hyper, S, exec, grim -g "$(slurp)" - | swappy -f -

# --- üéÆ GAMING (Baja Latencia) ---
windowrule {
    name = gaming-cs2
    match:class = ^(cs2)$
    immediate = on
    fullscreen = on
    no_blur = on
    opaque = on
}

windowrule {
    name = gaming-steam-apps
    match:class = ^(steam_app_\d+)$
    immediate = on
    no_blur = on
    opaque = on
}

windowrule {
    name = gaming-gamescope
    match:class = ^(.gamescope-wrapped)$
    immediate = on
    no_blur = on
    opaque = on
}

windowrule = float on, match:title ^(Friends List)$
windowrule = suppress_event activate activatefocus, match:class ^(steam)$

# --- üéà FLOTANTES ---
windowrule = float on, match:class ^(pavucontrol)$
windowrule = float on, match:class ^(swappy)$
windowrule = float on, match:class ^(org.kde.polkit-kde-authentication-agent-1)$

windowrule {
    name = coolercontrol
    match:class = ^(org.coolercontrol.CoolerControl)$
    float = on
    size = 1100 700
    center = on
}

windowrule {
    name = openrgb
    match:class = ^(openrgb)$
    float = on
    size = 1000 650
    center = on
}

# --- üß† JETBRAINS (WebStorm) ---
windowrule {
    name = webstorm-splash
    match:class = ^(jetbrains-webstorm)$
    match:title = ^(splash)$
    float = on
    center = on
}

windowrule {
    name = webstorm-popups
    match:class = ^(jetbrains-webstorm)$
    match:title = ^(win\d+)$
    no_anim = on
}

windowrule = center on, match:class ^(jetbrains-webstorm)$, match:float 1

# --- üñºÔ∏è PICTURE-IN-PICTURE ---
windowrule {
    name = pip
    match:title = ^(Picture-in-Picture)$
    float = on
    pin = on
    move = (monitor_w-window_w-10) (monitor_h-window_h-10)
}

# --- Scratchpad ---
windowrule {
    name = scratchpad
    match:workspace = special:scratchpad
    float = on
    size = 60% 60%
    center = on
}

# --- LAYER RULES ---
layerrule = blur on, match:namespace waybar
layerrule = ignore_alpha 0.3, match:namespace waybar
