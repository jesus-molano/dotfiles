# --- CATPPUCCIN MOCHA THEME ---
source = ~/.config/hypr/mocha.conf

################
### MONITORS ###
################
# --- MONITOR ---
monitor=HDMI-A-2,1920x1080@74.97,0x0,1
monitor=HDMI-A-1,1920x1080@74.97,1920x0,1

# --- ENV VARS (CR√çTICO PARA NVIDIA) ---
env = LIBVA_DRIVER_NAME,nvidia
env = XDG_SESSION_TYPE,wayland
env = GBM_BACKEND,nvidia-drm
env = __GLX_VENDOR_LIBRARY_NAME,nvidia
env = NVD_BACKEND,direct
env = ELECTRON_OZONE_PLATFORM_HINT,auto

# --- CURSOR THEME ---
env = XCURSOR_THEME,catppuccin-mocha-dark-cursors
env = XCURSOR_SIZE,24
env = HYPRCURSOR_THEME,catppuccin-mocha-dark-cursors
env = HYPRCURSOR_SIZE,24

# --- QT THEMING ---
env = QT_QPA_PLATFORMTHEME,qt6ct

# --- AUTOSTART ---
exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = /usr/lib/polkit-kde-authentication-agent-1
exec-once = waybar & swww-daemon & swaync
exec-once = sleep 1 && swww img /home/jesus/Pictures/wallhaven-ogy6zm_1920x1080.png
exec-once = ~/.config/hypr/scripts/reactive-rgb.sh &
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store
exec-once = kanata -c ~/.config/kanata/config.kbd # Aseguramos Kanata
exec-once = hypridle

# --- INPUT ---
input {
    kb_layout = us,es
    kb_options = grp:win_space_toggle
    follow_mouse = 1
    sensitivity = 0
    repeat_rate = 50
    repeat_delay = 300
}

# --- GENERAL ---
general {
    gaps_in = 4
    gaps_out = 8
    border_size = 2
    col.active_border = $mauve $blue 45deg
    col.inactive_border = $surface0
    layout = dwindle
    allow_tearing = true
}

decoration {
    rounding = 10
    blur {
        enabled = true
        size = 5
        passes = 2
	ignore_opacity = true
	new_optimizations = true
    }
}

animations {
    enabled = yes
    bezier = md3_decel, 0.05, 0.7, 0.1, 1
    animation = windows, 1, 3, md3_decel, popin 60%
    animation = workspaces, 1, 3, md3_decel, slide
}

dwindle {
    pseudotile = yes
    preserve_split = yes
    smart_split = no # Prefiero control manual
}

# --- VARIABLES ---
$mainMod = ALT
$hyper = CTRL ALT SUPER SHIFT

# --- BINDS ---
# Cambio de idioma: ALT + CTRL + SPACE
bind = $mainMod CTRL, SPACE, exec, hyprctl switchxkblayout all next

# Apps
bind = $mainMod, SPACE, exec, ~/.config/rofi/launchers/type-1/launcher.sh
bind = $hyper, RETURN, exec, kitty
bind = $hyper, B, exec, google-chrome-stable
bind = $hyper, E, exec, kitty -e yazi
bind = $hyper, C, exec, webstorm # IDE
bind = $hyper, N, exec, swaync-client -t -sw
bind = $hyper, P, exec, hyprpicker -a
bind = $hyper, M, exec, youtube-music
bind = $hyper, G, exec, mangohudctl toggle
bind = $hyper, D, exec, discord
bind = $hyper, 1, exec, 1password
bind = $hyper, L, exec, hyprlock

# Window Management (VIM HJKL)
bind = $mainMod, W, killactive
bind = $mainMod, h, movefocus, l
bind = $mainMod, l, movefocus, r
bind = $mainMod, k, movefocus, u
bind = $mainMod, j, movefocus, d

bind = $mainMod SHIFT, h, movewindow, l
bind = $mainMod SHIFT, l, movewindow, r
bind = $mainMod SHIFT, k, movewindow, u
bind = $mainMod SHIFT, j, movewindow, d

# Resize
binde = $mainMod CTRL, l, resizeactive, 40 0
binde = $mainMod CTRL, h, resizeactive, -40 0
binde = $mainMod CTRL, k, resizeactive, 0 -40
binde = $mainMod CTRL, j, resizeactive, 0 40

# Mouse bindings
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

# Workspaces
bind = $mainMod, 1, workspace, 1
bind = $mainMod, 2, workspace, 2
bind = $mainMod, 3, workspace, 3
bind = $mainMod, 4, workspace, 4
bind = $mainMod, 5, workspace, 5
bind = $mainMod, 6, workspace, 6

bind = $mainMod SHIFT, 1, movetoworkspace, 1
bind = $mainMod SHIFT, 2, movetoworkspace, 2
bind = $mainMod SHIFT, 3, movetoworkspace, 3
bind = $mainMod SHIFT, 4, movetoworkspace, 4
bind = $mainMod SHIFT, 5, movetoworkspace, 5
bind = $mainMod SHIFT, 6, movetoworkspace, 6

# --- WORKSPACE RULES (monitor assignment) ---
workspace = 1, monitor:HDMI-A-2
workspace = 2, monitor:HDMI-A-2
workspace = 3, monitor:HDMI-A-2
workspace = 4, monitor:HDMI-A-1
workspace = 5, monitor:HDMI-A-1
workspace = 6, monitor:HDMI-A-1

bind = $mainMod, M, fullscreen
bind = $mainMod, F, togglefloating
bind = $mainMod, C, exec, ~/.config/hypr/scripts/super-copy.sh
bind = $mainMod, V, exec, ~/.config/hypr/scripts/super-paste.sh
bind = $mainMod SHIFT, V, exec, cliphist list | rofi -dmenu -p "Clipboard" -theme ~/.config/rofi/launchers/type-1/style-2.rasi | cliphist decode | wl-copy
bind = $mainMod, A, exec, ~/.config/hypr/scripts/audio-toggle.sh

# --- üì∏ SCREENSHOTS ---
bind = $hyper, S, exec, grim -g "$(slurp)" - | swappy -f -

# --- üéÆ GAMING (Baja Latencia) ---
windowrule = immediate on, match:class ^(cs2)$
windowrule = fullscreen on, match:class ^(cs2)$
windowrule = immediate on, match:class ^(steam_app_\d+)$
windowrule = immediate on, match:class ^(.gamescope-wrapped)$
windowrule = float on, match:title ^(Friends List)$
windowrule = suppress_event activate activatefocus, match:class ^(steam)$

# --- üéà FLOTANTES ---
windowrule = float on, match:class ^(pavucontrol)$
windowrule = float on, match:class ^(swappy)$
windowrule = float on, match:class ^(org.kde.polkit-kde-authentication-agent-1)$

windowrule {
    name = coolercontrol
    match:class = ^(org.coolercontrol.CoolerControl)$
    float = on
    size = 1100 700
    center = on
}

windowrule {
    name = openrgb
    match:class = ^(openrgb)$
    float = on
    size = 1000 650
    center = on
}

# --- üñºÔ∏è PICTURE-IN-PICTURE ---
windowrule {
    name = pip
    match:title = ^(Picture-in-Picture)$
    float = on
    pin = on
    move = (monitor_w-window_w-10) (monitor_h-window_h-10)
}
